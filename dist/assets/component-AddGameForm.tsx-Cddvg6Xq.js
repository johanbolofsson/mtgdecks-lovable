import{r as e,j as s,R as a}from"./react-core-CnGHm5UM.js";import{R as i,a as r,L as n,B as t}from"./component-ui-BiEVUsOz.js";import{u as o}from"./hooks-k93NwXX7.js";import{c as d}from"./vendor-CVxbL24y.js";const l=d("https://zwlnljwztedfqxlumoch.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inp3bG5sand6dGVkZnF4bHVtb2NoIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzM4NDA4NzUsImV4cCI6MjA0OTQxNjg3NX0.e0r6MR4KsUSLspl1SVX8zKT0z3XrEMdh-YTumHPp9ck"),c=e.createContext({user:null,isLoading:!0}),m=({children:a})=>{const[i,r]=e.useState(null),[n,t]=e.useState(!0);return e.useEffect((()=>{l.auth.getSession().then((({data:{session:e}})=>{r(e?.user??null),t(!1)}));const{data:{subscription:e}}=l.auth.onAuthStateChange(((e,s)=>{r(s?.user??null),t(!1)}));return()=>e.unsubscribe()}),[]),s.jsx(c.Provider,{value:{user:i,isLoading:n},children:a})},u=()=>e.useContext(c),p=({deckId:e,onGameAdded:d})=>{const{toast:c}=o(),{user:m}=u(),[p,h]=a.useState("win"),[g,I]=a.useState(!1);return s.jsxs("form",{onSubmit:async s=>{if(s.preventDefault(),m){I(!0);try{const{data:s,error:a}=await l.from("game").insert({}).select().single();if(a)throw a;const{error:i}=await l.from("game_details").insert({game_id:s.id,deck_id:e,winner:"win"===p,player_id:m.id});if(i)throw i;c({title:"Game Added",description:`Recorded ${p} for this deck`}),d()}catch(a){c({variant:"destructive",title:"Error saving game",description:"There was an error saving your game. Please try again."})}finally{I(!1)}}else c({variant:"destructive",title:"Error saving game",description:"You must be logged in to add a game."})},className:"space-y-6",children:[s.jsxs(i,{value:p,onValueChange:e=>h(e),className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(r,{value:"win",id:"win"}),s.jsx(n,{htmlFor:"win",children:"Win"})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(r,{value:"loss",id:"loss"}),s.jsx(n,{htmlFor:"loss",children:"Loss"})]})]}),s.jsx(t,{type:"submit",className:"w-full",disabled:g,children:g?"Saving...":"Add Game"})]})};export{p as A,m as a,l as s,u};
